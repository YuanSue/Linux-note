<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>Linux note</title>
  
  <!-- 字型與樣式 -->
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@500;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Noto Sans TC', sans-serif;
      margin: 30px;
      color: #222;
    }

    h1 {
      text-align: center;
    }

    h2 {
      font-weight: 700;
      font-size: 1.5em;
      color: #975;
      margin-top: 40px;
    }

    .under{
      text-decoration: underline;
      text-decoration-color: black;
    }

    .red-text {
      font-weight: bold;
      text-decoration-thickness: 2px;
      color: red;
    }

    .blue-text {
      font-weight: bold;
      text-decoration-thickness: 2px;
      color: rgb(105, 135, 190);
    }

    /* 表格樣式 */
    table {
      width: 90%;
      margin: 20px auto;
      border-collapse: collapse;
      text-align: center;
    }

    th, td {
      border: 1px solid #ccc;
      padding: 12px;
    }

    th {
      background-color: #f5f5f5;
    }

    tr:nth-child(even) {
      background-color: #fafafa;
    }

    code {
      font-family: 'Noto Sans TC', sans-serif;
      background-color: #f2f2f2;
      padding: 2px 4px;
      border-radius: 4px;
    }

    /* 程式碼框選格式 */
    .code-block {
      position: relative;
      background-color: #272822;
      color: #f8f8f2;
      padding: 1rem;
      border-radius: 10px;
      border: 3px solid #000000;
      font-family: 'Courier New', monospace;
      line-height: 1.5;
      white-space: pre;
      overflow-x: auto;
    }

    .copy-button {
      position: absolute;
      top: 10px;
      right: 10px;
      padding: 5px 10px;
      font-size: 0.8rem;
      cursor: pointer;
      background-color: #4CAF50;
      color: white;
      border: none;
      border-radius: 5px;
    }

    .copy-button:hover {
      background-color: #45a049;
    }

    /* 索引面板樣式 */
    .index-panel {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 1000;
    }

    .index-toggle {
      background-color: #007bff;
      color: white;
      border: none;
      border-radius: 50%;
      width: 70px;
      height: 70px;
      font-size: 30px;
      cursor: pointer;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
      transition: all 0.3s ease;
    }

    .index-toggle:hover {
      background-color: #0056b3;
      transform: scale(1.1);
    }

    .index-menu {
      position: absolute;
      top: 60px;
      right: 0;
      background: white;
      border: 2px solid #007bff;
      border-radius: 10px;
      padding: 15px;
      min-width: 250px;
      max-height: 400px;
      overflow-y: auto;
      box-shadow: 0 8px 16px rgba(0,0,0,0.15);
      display: none;
    }

    .index-menu.show {
      display: block;
      animation: slideIn 0.3s ease;
    }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .index-item {
      display: block;
      text-decoration: none;
      color: #333;
      padding: 8px 12px;
      border-radius: 5px;
      margin-bottom: 5px;
      transition: background-color 0.2s ease;
    }

    .index-item:hover {
      background-color: #f0f8ff;
      color: #007bff;
    }

    .index-title {
      font-weight: bold;
      color: #007bff;
      margin-bottom: 10px;
      text-align: center;
      border-bottom: 1px solid #e0e0e0;
      padding-bottom: 8px;
    }

    /*圖片置中*/
    .center-img {
    display: block;
    margin: 0 auto;
  }
  /*樹狀圖調整樣式*/
  .tree-block {
      font-family: 'Courier New', monospace;
      font-size: 16px;
      background-color: #f9f9f9;
      color: #333;
      border-left: 4px solid #4e73df;
      padding: 12px 16px;
      margin: 16px 0;
      white-space: pre;
      line-height: 1.6;
      tab-size: 4; /* 支援 tab 縮排 */
    }

    .tree-block .blue-text {
      color: #007acc;
      font-weight: bold;
    }

    .tree-block .gray-text {
      color: #888;
    }

  </style>
</head>
<body>
  <!-- 索引面板 -->
  <div class="index-panel">
    <button class="index-toggle" onclick="toggleIndex()">🔍</button>
    <div class="index-menu" id="indexMenu">
      <div class="index-title">頁面索引</div>
      <a href="#section1" class="index-item">Install and build VM</a>
      <a href="#section2" class="index-item">開始安裝DS</a>
      <a href="#section3" class="index-item">Install red hat</a>
    </div>
  </div>

  <h1><a href="index.html"> 從0開始安裝VM以及DS</a></h1>
  <h2 id="section1">Install and build VM</h2>
  <h3>oracle virtualbox 載點</h3>
  <a href="https://drive.google.com/drive/folders/1yZ2MPgHSVrHLaWyRR5RiAk5TDiYVaQ5J?usp=drive_link" target="_blank">ver.20250805</a>
  <h3>ISO位置</h3>
  <p>ISO位置: 進入到Nas後路徑: Software\Linux\RHEL\AS9\AS9.3</p>

  <h3>Install red hat</h3>
  <p>安裝完virtualbox之後開啟建立VM，點選Tool->新增</p>
    <img src="img/I1.png" alt="無法顯示" width="800" class="center-img">
  <p>創建VM: Name為VM名; Folder為VM存放位置; ISO Image為要輸入的映像檔</p>
    <img src="img/I2.png" alt="無法顯示" width="800" class="center-img">
  <p>host_name/帳號/密碼設定:</p>
    <img src="img/I3.png" alt="無法顯示" width="800" class="center-img">
  <p>範例中給予 16G的RAM(DS安裝最低需求)以及2顆CPU</p>
    <img src="img/I4.png" alt="無法顯示" width="800" class="center-img">
  <p>建立Disk (範例中給予200GB)，完成後先關掉VM</p>
    <img src="img/I5.png" alt="無法顯示" width="800" class="center-img">
  <p>!!!點選"設置"(與"新增"同列)setting裡面在安裝vm的時候開機順序需要先把光碟放在前面!!!</p>
    <img src="img/I6.png" alt="無法顯示" width="800" class="center-img">
  <p>檢查IDE是否有讀取到光碟(更新rpm的時候會用到，以及安裝vm的時候會用到)</p>
    <img src="img/I7.png" alt="無法顯示" width="800" class="center-img">
  <p>將NAT改成橋接介面卡</p>
    <img src="img/I8.png" alt="無法顯示" width="800" class="center-img"> 
  <p>完成後開機<br>DISK的切割(點選自訂 -> 確認200G硬碟有被選取 ->完成)</p>
    <img src="img/I9.png" alt="無法顯示" width="800" class="center-img">
  <p>切割細項:<br><span class="red-text">以下出現etl的路徑是上述u01的自定義，若有出現etl的路徑務必要改成當前你自定義的名稱</span></p>
    <img src="img/I10.png" alt="無法顯示" width="800" class="center-img">  
  <p>完整安裝完後，確認映象檔是否去除(重開機的時候檢查，通常做了開機順序調整時系統會自動移除)</p>
    <img src="img/I11.png" alt="無法顯示" width="1000" class="center-img">
  <p>VM安裝部分差不多就這樣 可能要注意的就是需要把網路設定成bridege 讓其他硬體也能連接，以及DNS要設定好8.8.8.8(GOOGLE)不能後續update套件的時候可能會無法連上網路</p>

  <h3>查IP上Putty</h3>
  <p>左上角 概覽 -> terminal -> 輸入<code>ip addr show</code>找到IP<br>開啟Putty輸入IP(port號都為22)</p>
  
  <h2 id="#section2">開始安裝DS</h2>
  <h3>安裝DS版本: 11.7.1.5， 在 RH810下， 資料庫使用DB2</h3>
  <p>目的：將NAS上的安裝檔放到VM中
    <br>1.抓取安裝包 (SFTP)，先進入到自定義的u01資料夾下<code>cd /u01</code>
    <br>2.確認 Red Hat 虛擬機能連線到 NAS: <code>ping 192.168.1.17</code>
    <br>如果可以成功 ping 到，代表網路通順(持續監聽代表成功)。若無法通，不要進行後續，請先檢查虛擬機網路設定（如：橋接模式 / NAT / Host-only）。 
    <br>3.輸入以下指令(NAS有開啟 SSH/SFTP 功能)：<code>sftp will@192.168.1.17</code>
    <br>- will 是 NAS 的使用者名稱（請確認）<br>- 若首次連線會問是否信任主機，請輸入 yes<br>- 然後輸入密碼登入
    <br>4.進入到sftp> 後，找到路徑 cd \192.168.1.17\ibm\SW\InfoSphere\DS\IIS11.7\11.7.1.5(可能需慢慢往下找)
    <br>5.進到資料夾後下載檔案<code>get IS_V11713_EE_bundle_spec_file.zip</code>以及<code>get IS_V11715_Linux_x86_multi.tar.gz</code>
    <br>關閉sftp> exit
    <br>6.確認get的檔案
</p>
    <img src="img/I12.png" alt="無法顯示" width="1000" class="center-img">

  <h3>開始前置作業</h3>
  <p>檢查是否可以正常安裝 Red Hat 外所需的套件依賴項:<br>路徑:<code>cd /etc/yum.repos.d/</code>
    <br>先檢查目前是否需要做以下的掛載步驟：<code>yum repolist</code>，若看到 repo 是空的或顯示錯誤（例如 subscription 錯誤），代表系統缺少可用的套件來源。
    <br>yum repolist，是用來「查看目前可用的套件倉儲（repositories）列表及其狀態」。
    <br><code>yum repolist all</code>: 檢查是否啟動
    <br>若未啟動，執行以下步驟: <br>1. 重新手動掛載ISO檔(開VM右下角"choose a disk file") 
  </p>
    <img src="img/I13.png" alt="無法顯示" width="1000" class="center-img">
  <p>2. 建立檔案 -> mount cdrom: <code>mkdir /mnt/cdrom</code> -> <code>mount /dev/cdrom /mnt/cdrom</code>
     <br>3. 進路徑-> copy file: <code>cd /mnt/cdrom</code> -> <code>cp /mnt/cdrom/media.repo /etc/yum.repos.d/</code>(或者<code>cp /mnt/cdrom/media.repo /etc/yum.repos.d/</code>)
     <br>4. <code>chmod 644 /etc/yum.repos.d/media.repo</code> -> <code>cd /etc/yum.repos.d/</code> -> <code>vi media.repo</code>
     <br>輸入內容如下(<span class="red-text">將其他內容刪除，保留以下內容即可</span>):
     </p>
     
     <div class="code-block" id="sqlCode">
      <button class="copy-button" onclick="copyCode(this)">複製</button>
      <span class="code-content">[InstallMedia-BaseOS]
          name=Red Hat Enterprise Linux 8 - BaseOS
          baseurl=file:///mnt/cdrom/BaseOS/
          metadata_expire=-1
          gpgcheck=0
          enabled=1
          [InstallMedia-AppStream]
          name=Red Hat Enterprise Linux 8 - AppStream
          baseurl=file:///mnt/cdrom/AppStream
          metadata_expire=-1
          gpgcheck=0
          enabled=1
          </span>
    </div>
    <p>再次確認:<code>yum repolist</code> -> <code>yum repolist all</code>
       <br>預先安裝以下的package清單(版本比建議的新即可):
       <br><code>yum install -y glibc libXp libXau libXext libX11 libxcb libXmu libXtst nss-softokn-freebl bc net-tools lsof libaio gcc-c++ ed perl wget less util-linux sed grep tar libnsl gcc elfutils</code>
    </p>

    <h3>確認SELinux及防火牆是否關閉 | 此步驟兩個一起修改完後重開機</h3>
    <p>確認SELINUX是否為disable: <code>vi /etc/selinux/config</code>， 如果不是，將enforcing改成disable<br>
      關閉防火牆輸入:<code>systemctl stop firewalld</code>, 讓防火牆重開機不會起來:<code>systemctl disable firewalld</code>, 確認防火牆狀態:<code>systemctl status firewalld</code><br>
      重新vi: <code>sudo vi /etc/sysctl.conf</code><br>輸入以下資訊:
    </p>
    
    <div class="code-block" id="sqlCode">
      <button class="copy-button" onclick="copyCode(this)">複製</button>
      <span class="code-content">kernel.msgmax=65536
kernel.msgmnb=65536
kernel.sem=250 256000 32 1024
          </span>
    </div>
    <p>使其生效:<code>sysctl -p</code>,	將open file檔案大小改為10240:<code>ulimit -n 10240</code></p>

    <h3>安裝開始</h3>
    <p>1. 到儲存位置下(以u01為範例，cd到u01)，輸入<code>tar -xvf IS_V11715_Linux_x86_multi.tar.gz</code> (這會自己新增一個is-suite)<br>
       2. 將IS_V11713_EE_bundle_spec_file.zip，放到is-suite的資料夾: <code>mv /u01/IS_V11713_EE_bundle_spec_file.zip /u01/is-suite/</code>
       <br>確認:<code>ls /u01/is-suite/</code><br>
       3. 在is-suite中 unzip IS_V11713_bundle_spec_file.zip: <code>unzip IS_V11713_EE_bundle_spec_file.zip</code><br>
       4. 在繼續setup之前要先設定hostname:<br>
       &nbsp;&nbsp;&nbsp;&nbsp;a. 切到 win 找路徑C:\Windows\System32\drivers\etc，新增hostname(找記事本 -> 右鍵"以系統管理員執行" -> 輸入hostname(e.g. 192.168.1.162 jim))<br>
       &nbsp;&nbsp;&nbsp;&nbsp;b. 到linux(或是putty)進行修改，公式：sudo hostnamectl set-hostname 新主機名稱; 範例：sudo hostnamectl set-hostname my-server(**這裡換IP名看看./setup的連結會不會換成IP)<br>
       5. 繼續下面操作<code>./setup</code>，將連結複製到瀏覽器並把圖中的jim更名為自己的IP位置
    </p>
    <img src="img/I14.png" alt="無法顯示" width="1000" class="center-img">

  <script>
    function copyCode(button) {
      // 找到按鈕所在的程式碼區塊
      const codeBlock = button.parentElement;
      // 找到程式碼內容元素
      const codeContent = codeBlock.querySelector('.code-content');
      
      if (codeContent) {
        navigator.clipboard.writeText(codeContent.textContent).then(() => {
          alert("已複製 SQL 程式碼！");
        });
      }
    }

    function toggleIndex() {
      const indexMenu = document.getElementById('indexMenu');
      indexMenu.classList.toggle('show');
    }

    // 點擊其他地方時關閉索引面板
    document.addEventListener('click', function(event) {
      const indexPanel = document.querySelector('.index-panel');
      const indexMenu = document.getElementById('indexMenu');
      
      if (!indexPanel.contains(event.target)) {
        indexMenu.classList.remove('show');
      }
    });

    // 點擊索引項目後關閉面板並平滑滾動
    document.querySelectorAll('.index-item').forEach(item => {
      item.addEventListener('click', function(event) {
        event.preventDefault();
        const targetId = this.getAttribute('href').substring(1);
        const targetElement = document.getElementById(targetId);
        
        if (targetElement) {
          targetElement.scrollIntoView({
            behavior: 'smooth',
            block: 'start'
          });
        }
        
        // 關閉索引面板
        document.getElementById('indexMenu').classList.remove('show');
      });
    });
  </script>

 <a href="index.html">← 回首頁</a>
</body>
</html>